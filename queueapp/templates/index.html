{% load static %}
<!DOCTYPE html>
<html>
  <head>
    <title>CrowdQueue</title>
    <link rel="stylesheet" href="{% static 'queueapp/style.css' %}" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    />
    <script>
      function refreshQueue() {
        fetch("/queue-data/")
          .then((res) => res.json())
          .then((data) => {
            let list = document.getElementById("queueList");
            list.innerHTML = "";
            data.queue.forEach((entry) => {
              list.innerHTML += `<li class="list-group-item">#${entry.number} - ${entry.name}</li>`;
            });
          });
      }
      setInterval(refreshQueue, 3000); // refresh every 3 sec
    </script>
  </head>
  <body class="container py-5">
    <h2>CrowdQueue â€“ Real-time Queue</h2>
    <form method="POST" action="/join/">
      {% csrf_token %}
      <input
        type="text"
        name="name"
        placeholder="Your Name"
        required
        class="form-control my-2"
      />
      <input
        type="text"
        name="phone"
        placeholder="Phone (optional)"
        class="form-control my-2"
      />
      <input
        type="email"
        name="email"
        placeholder="Email (optional)"
        class="form-control my-2"
      />
      <button type="submit" class="btn btn-primary">Join Queue</button>
    </form>

    <hr />
    <h4>Waiting Queue:</h4>
    <ul id="queueList" class="list-group">
      {% for entry in entries %}
      <li class="list-group-item">#{{ entry.number }} - {{ entry.name }}</li>
      {% endfor %}
    </ul>
  </body>
</html>
